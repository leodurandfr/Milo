# ALSA configuration for Milo Client with CamillaDSP support
# ============================================================
# Audio routing with optional DSP processing:
# - Direct: Snapclient -> HiFiBerry (no DSP)
# - With DSP: Snapclient -> Loopback -> CamillaDSP -> HiFiBerry

# === Default Output ===
# Routes to HiFiBerry directly (no DSP)
pcm.!default {
    type plug
    slave.pcm "hifiberry"
}

ctl.!default {
    type hw
    card sndrpihifiberry
}

# === HiFiBerry Direct Output ===
pcm.hifiberry {
    type plug
    slave.pcm {
        type hw
        card sndrpihifiberry
        device 0
    }
}

# === CamillaDSP Input (via Loopback) ===
# Audio sent here is captured by CamillaDSP for processing
pcm.camilladsp_input {
    type plug
    slave.pcm {
        type hw
        card Loopback
        device 0
        subdevice 0
    }
}

# === DSP-Enabled Output ===
# Use this for audio that should go through CamillaDSP
pcm.with_dsp {
    type plug
    slave.pcm "camilladsp_input"
}

# === Snapclient Output Selector ===
# The milo-client application sets MILO_CLIENT_DSP_ENABLED env var
# to route snapclient output to DSP or direct based on main Milo settings
pcm.milo_client_output {
    type plug
    slave.pcm "hifiberry"
}
